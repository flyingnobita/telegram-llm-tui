# PLANS 3.1.5 - UI cache wiring

## 3.1.5.1 Feature scope

1. [x] (3.1.5.1.1) Map cache chat summaries into UI chat list items.
2. [x] (3.1.5.1.2) Map cache messages into UI message items for selection.
3. [x] (3.1.5.1.3) Choose a default selected chat when none is set.
4. [x] (3.1.5.1.4) Preserve composer and overlay state on refresh.
5. [x] (3.1.5.1.5) Format message timestamps consistently.

## 3.1.5.2 Implementation notes

1. [x] (3.1.5.2.1) Add `app/src/ui_state.rs` cache-to-UI mapping helpers.
2. [x] (3.1.5.2.2) Add a bridge struct to hold selection and UI state.
3. [x] (3.1.5.2.3) Refresh UI state after cache updates in the app loop.
4. [x] (3.1.5.2.4) Add unit tests for selection, sorting, and mapping.

## 3.1.5.3 Current state checklist

1. [x] (3.1.5.3.1) Mapping helpers implemented.
2. [x] (3.1.5.3.2) Bridge struct holds UI state and selection.
3. [x] (3.1.5.3.3) App loop refreshes UI state from cache.
4. [x] (3.1.5.3.4) Unit tests passing.

## 3.1.5.4 Next steps

1. [x] (3.1.5.4.1) Implement mapping helpers and bridge.
2. [x] (3.1.5.4.2) Wire bridge into the app loop.
3. [x] (3.1.5.4.3) Add and run unit tests.

## 3.1.5.5 Follow-ups and gaps

1. [ ] (3.1.5.5.1) Replace fallback author labels with resolved display names.
2. [ ] (3.1.5.5.2) Add paging and scrollback for large message lists.

## 3.1.5.6 Logging

1. (3.1.5.6.1) Primary log file is `data/logs/app.log` (configured in
   `app/config/app.toml`).
2. (3.1.5.6.2) Error log file is `data/logs/app-error.log` (configured in
   `app/config/app.toml`).
3. (3.1.5.6.3) Log level uses `[logging].level` in `app/config/app.toml`
   (default `info`).
4. (3.1.5.6.4) Log format uses `[logging].format` in `app/config/app.toml`
   (default `plain`).
5. (3.1.5.6.5) Rotation uses `[logging].rotation` and size-based defaults in
   `app/config/app.toml`.
