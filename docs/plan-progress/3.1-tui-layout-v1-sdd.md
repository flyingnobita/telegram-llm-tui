# SDD 3.1 - TUI layout v1

## 1.0 Idea

Deliver a usable first layout for the TUI that organizes chats, messages, and
composition while supporting overlays for the command palette and LLM draft
review.

## 2.0 Structured spec

### 2.1 Scope

- [x] (2.1.1) Render a left chat list column with selection highlighting.
- [x] (2.1.2) Render a main message view column with wrapped message text.
- [x] (2.1.3) Render a bottom composer panel for in-progress input.
- [x] (2.1.4) Render a centered modal overlay for LLM draft review.
- [x] (2.1.5) Render a centered command palette overlay with query and actions.
- [x] (2.1.6) Provide empty-state placeholders for chats and messages.

### 2.2 Out of scope

- [ ] (2.2.1) Scrollback, paging, or message virtualization.
- [ ] (2.2.2) Message selection, multi-select, or export markers.
- [ ] (2.2.3) Input keybindings and command routing.
- [ ] (2.2.4) Theming, accessibility modes, or custom palettes.
- [ ] (2.2.5) Status bar and notifications.

### 2.3 Layout regions

- [x] (2.3.1) Root layout is vertical: main body plus a fixed-height composer.
- [x] (2.3.2) Main body is horizontal: chat list on the left, messages on the
  right.
- [x] (2.3.3) Chat list width is fixed (default 24 columns) with borders.
- [x] (2.3.4) Composer height is fixed (default 3 rows) with borders.

### 2.4 Chat list behavior

- [x] (2.4.1) Each chat row shows the title and unread count when non-zero.
- [x] (2.4.2) Selected chat is visually highlighted.
- [x] (2.4.3) Empty chat list shows a placeholder label.

### 2.5 Message view behavior

- [x] (2.5.1) Messages are rendered top to bottom with timestamp, author, body.
- [x] (2.5.2) Text wraps within the message pane.
- [x] (2.5.3) Empty message list shows a placeholder label.

### 2.6 Draft modal overlay

- [x] (2.6.1) Modal is centered at 70 percent width and 60 percent height.
- [x] (2.6.2) Modal clears the background before rendering the draft content.
- [x] (2.6.3) Modal displays a title and wrapped body text.

### 2.7 Command palette overlay

- [x] (2.7.1) Palette is centered at 60 percent width and 35 percent height.
- [x] (2.7.2) Palette shows the query input row and an action list.
- [x] (2.7.3) Selected action is highlighted.
- [x] (2.7.4) Empty action list shows a placeholder label.

### 2.8 Overlay precedence

- [x] (2.8.1) Base layout renders before overlays.
- [x] (2.8.2) Draft modal renders above the base layout.
- [x] (2.8.3) Command palette renders above the draft modal when both are open.

### 2.9 State model

- [x] (2.9.1) `UiState` includes chat list, message list, composer, and overlay
  state.
- [x] (2.9.2) Overlay state includes visibility flags and content strings.

## 3.0 Implementation plan

- [x] (3.1.1) Extend `ui::view::UiState` with chat, message, and overlay state.
- [x] (3.1.2) Render the base layout with chat list, messages, and composer.
- [x] (3.1.3) Render the draft modal overlay using `Clear` and centered rects.
- [x] (3.1.4) Render the command palette overlay with query and actions.
- [x] (3.1.5) Add layout snapshot tests for base, modal, and palette.
- [x] (3.1.6) Update existing snapshots for the new layout.

## 4.0 Test plan (generation)

- [x] (4.1.1) Snapshot test for the base layout with sample data.
- [x] (4.1.2) Snapshot test for the command palette overlay.
- [x] (4.1.3) Snapshot test for the LLM draft modal overlay.

## 5.0 Code plan (follow-up after tests)

- [x] (5.1.1) Implement new view state types for chats, messages, and overlays.
- [x] (5.1.2) Wire layout rendering functions and helper rect math.
- [x] (5.1.3) Run `cargo fmt`, `cargo clippy -D warnings`, and UI tests.
