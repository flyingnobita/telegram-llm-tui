# PLANS 3.2 - Input ergonomics

## 3.2.1 Feature scope

1. [x] (3.2.1.1) Add a focus model for chats, messages, composer, and search.
2. [x] (3.2.1.2) Provide vim-style keymap support for navigation and search.
3. [x] (3.2.1.3) Provide VSCode-style keymap support for navigation and search.
4. [x] (3.2.1.4) Implement message cursor, scrollback, and paging.
5. [x] (3.2.1.5) Implement message selection toggles for export prep.
6. [x] (3.2.1.6) Implement in-chat search with match cycling and markers.

## 3.2.2 Implementation notes

1. [x] (3.2.2.1) Add `ui::interaction` with keymap-aware handlers.
2. [x] (3.2.2.2) Extend `ui::view::UiState` with message view state and search.
3. [x] (3.2.2.3) Render message cursor, selection, and search markers.
4. [x] (3.2.2.4) Reconcile selection and cursor state on cache refresh.
5. [x] (3.2.2.5) Add unit tests for key handling and search behavior.

## 3.2.3 Current state checklist

1. [x] (3.2.3.1) Focus and keymap-aware navigation in `ui::interaction`.
2. [x] (3.2.3.2) Scrollback and paging controls for the message view.
3. [x] (3.2.3.3) Search state, match tracking, and cycling.
4. [x] (3.2.3.4) Message selection state with selection markers.
5. [x] (3.2.3.5) Updated cache mapping includes message and chat IDs.
6. [x] (3.2.3.6) Snapshot and unit tests updated for new UI state.

## 3.2.4 Next steps

1. [ ] (3.2.4.1) Wire keymap selection into config and the runtime event loop.
2. [ ] (3.2.4.2) Derive message page size from the viewport at runtime.
3. [ ] (3.2.4.3) Add export actions once the LLM pipeline is ready.

## 3.2.5 Logging

1. (3.2.5.1) Primary log file is `data/logs/app.log` (configured in
   `app/config/app.toml`).
2. (3.2.5.2) Error log file is `data/logs/app-error.log` (configured in
   `app/config/app.toml`).
3. (3.2.5.3) Log level uses `[logging].level` in `app/config/app.toml`
   (default `info`).
4. (3.2.5.4) Log format uses `[logging].format` in `app/config/app.toml`
   (default `plain`).
5. (3.2.5.5) Rotation uses `[logging].rotation` and size-based defaults in
   `app/config/app.toml`.
